---
title: 密码学
date: 2023-09-08 11:54:36
tags: 
categories: 
---

**目录 start**

1. [密码学](#密码学)
1. [古典密码学](#古典密码学)
    1. [凯撒密码](#凯撒密码)
    1. [简单替换密码](#简单替换密码)
    1. [多表加密](#多表加密)
    1. [一次性密码本](#一次性密码本)
1. [现代密码学](#现代密码学)
    1. [编码](#编码)
    1. [对称密码](#对称密码)
        1. [DES](#des)
        1. [AES](#aes)
        1. [分组密码和流密码](#分组密码和流密码)
        1. [分组密码的模式](#分组密码的模式)
    1. [公钥密码](#公钥密码)
    1. [散列函数](#散列函数)
    1. [消息认证码](#消息认证码)
    1. [数字签名](#数字签名)
        1. [签名与验签](#签名与验签)
    1. [证书](#证书)
    1. [密钥](#密钥)
    1. [随机数](#随机数)
1. [集大成者](#集大成者)
    1. [PGP](#pgp)
    1. [SSL TLS](#ssl-tls)

**目录 end**|_2023-09-10 17:24_|
****************************************
# 密码学
> [wikipedia](https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%AD%A6)


> 基础概念：
- 明文(plaintext) 加密(encrypt) 得到 密文(ciphertext)，解密则是逆向过程
    - 加密 解密算法合称 密码算法，密码算法中通常都需要密钥（key）
- 对称密码 和 公钥密码：保证数据的机密性
    - 对称密码即加密和解密使用同一个密钥，公钥密码则是加密和解密使用不同的密钥（分为公钥和私钥）。还有混合密码系统则是结合两种方式一起使用
- hash函数： 为了保证数据的完整性，即数据没有被篡改过。
- 消息认证码： 保证完整性并提供认证机制，例如身份证中的校验位
- 数字签名：保证完整性，提供认证机制，防止否认
- 伪随机数生成器： 模拟产生随机数的算法。如果生成随机数的算法设计不好，则攻击者容易推测出密钥
- 隐写术：将消息藏入明文，密码隐藏的是明文，隐写术隐藏的明文消息
    - 计算机中的数字水印就使用了该技术设计，例如将需要嵌入的消息加密得到密文再通过隐写术藏到载体上（图片，视频，音频），达到签名，溯源的目的
- 社会工程学（social engineering）攻击: 安全系统内的短板在于人类自身。
- 密钥加密密钥（Key Encrypting Key， KEK）

最佳实践：
- 不要使用保密的密码算法，而应该使用市面上公开的高强度的密码算法
- 使用低强度的密码比不进行任何加密更危险
- 任何密码总有一天都会被破解，重点在于攻击的投入产出比
- 密码只是信息安全的一部分
- 低强度加密算法对明文的多轮加密的安全性等同于单次加密

参考：
- [可汗学院： 计算机科学-密码学](https://zh.khanacademy.org/computing/computer-science/cryptography)
- 《图解密码技术》


************************

# 古典密码学
> [wikipedia](https://zh.wikipedia.org/wiki/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A2%BC)  

> [异或与一次性密码本](https://zh.khanacademy.org/computing/computer-science/cryptography/ciphers/a/xor-and-the-one-time-pad)`异或运算后，原始信息无法辨别了`

## 凯撒密码
凯撒密码是一种移位密码，将明文按固定偏移量将明文转换为密文。

例如：明文 you 经过3个移位得到密文brx。
缺陷：
- 英文语句中每个字母的出现频率是有固定的差异，可以从密文的字母出现频率对照原始字母的频率从而推算出偏移量
- 密钥只有26种，密钥空间极小，可以暴力计算（又称 穷举搜索）所有的密钥解密得到明文

## 简单替换密码
将原始的26个字母，打乱后得到替换表，将明文中的字母一一对应并替换，从而将明文加密为密文

改进点： 密钥空间从26种扩大到 26！种
缺陷： 
- 同样可以通过字母频率分析，结合单词组（类似数独的解法），推算出替换表
- 密文越长越容易破解（给出了更多的信息）

## 多表加密
将一个单词设置为密钥，单词内的每个字符的自然序循环使用作为偏移量对明文进行加密

例如：明文 how are you 密钥 yes（25，5，19） 计算得到密文：__
缺陷：密钥一般短于明文，还是能得到偏移的规律

## 一次性密码本
> 一次性密码本(one time pad)是一种绝对无法被破译的密码  
> 一次性密码本由 G.S.Vernam 在1917年提出 并由 香农(C.E.Shannon) 在1949年数学方法证明，它是无条件安全的(unconditionally secure)，在理论上是无法破译的(theoretically unbreakable)。

设置一个与明文长度一致的字符串作为密码本，对明文每个字母按密码本对应的字母的自然序进行移位。

如果在计算机的范畴，一次性密码本则是与明文编码后二进制串等长的二进制串。而且明文二进制串通过和密码本异或运算得到密文（且和或会保留大量的明文信息特征）。

例如： 明文 how are you 密钥 uwoiufpqx 计算得到密文：__

一次性密码本是无法破译的： 因为即使拿到了密文，穷举了密钥，得到明文，但是会发现得到多个情况的明文，无法判断哪个明文才是这个密文真正要携带信息的明文。

即使理论上是无法破译的，但是在实用性上几乎是无法使用： 密钥每次都是需要和密文一起发送给接受方，密文中的信息才能有效被传达，然后矛盾点来了，如何安全的传输与明文等长的密钥。

一次性密码本和明文长度一样，是否可以压缩。答案：否，因为压缩过程是对重复序列的再编码，得到短序列，从而实现压缩，但是一次性密码本是随机的，不包含任何冗余重复序列。

************************

# 现代密码学

## 编码
现代密码学都是建立在计算机的基础上，因此需要编码（将 文字，图像，音视频 等 转换成比特序列）。

## 对称密码

### DES
Data Encryption Standard 是 1977年美国联邦信息处理标准中所采用的对称密码。 

DES是一种将64比特的明文加密成64位比特的密文的对称加密算法(分组密码的一种)，密钥长度为64位： 56位+错误检验的8比特（每隔7位设置一位）  
使用Feistel网络作为基本结构，经过多轮分组加密 得到密文。详细过程参考书籍《图解密码技术》

`三重DES`
加密过程：明文 密钥1加密 密钥2解密 密钥3加密 得到密文。 解密过程相反： 密钥3解密 密钥2加密 密钥1解密  
优点：增加了DES算法的强度（加大了密钥空间）， 缺陷： 计算量大

> DES 密钥空间是 2^56种， 三重DES则是 2^168种。

### AES 
Advanced Encryption Standard。在全世界范围进行公开竞选， 有15个算法进入候选范围，最终 Rijndael 获胜成为AES

同为分组加密算法，分组长度为128比特，密钥长度可选（128，192，256位），使用SPN结构进行多轮加密。 详细过程参考书籍《图解密码技术》  
而且加密过程的步骤可以并行计算，性能较DES也更好。  
Rijndael算法背后是严谨的数学论证：明文到密文的计算过程全部可以用数学公式来表达。  

### 分组密码和流密码
分组密码(block cipher)是指每次只能处理固定长度数据的一类密码算法。例如 DES，AES等
流密码(stream cipher)是对数据流连续处理的一类密码算法。

分组密码处理完一个分组就结束了，因此不需要内部状态来记录维护加密的进度，反之流密码是对一串数据流进行连续处理，是有状态的。

> 由于明文不可能总是密钥的整数倍长，因此需要对最后一个明文分组进行数据填充(padding)达到对齐

### 分组密码的模式
> 分组密码算法需要对分段的明文进行迭代加密，迭代的方法称为模式。

《实用密码学》中指出，推荐使用CBC模式和CTR模式。

- ECB：Electronic CodeBook mode 电子密码本模式
- CBC：Cipher Block Chaining mode 密码分组链接模式
- CFB：Cipher FeekBack mode 密文反馈模式
- OFB：Output FeedBack mode 输出反馈模式
- CTR：CounTeR mode 计数器模式

ECB模式是按序迭代，也是最容易有安全漏洞的算法，通常不被实际使用。
- 因为ECB模式下，明文分组和密文分组是按序一一对应的，那理论上可以通过对密文分组的 复制，调序，剪切 等操作，从而达到篡改明文的目的。
- 但是如果使用消息认证码，则可以发现密文被篡改

CBC模式相较于ECB，在每个明文分组加密为密文分组前，都需要拿前一个密文分组对当前明文分组做异或（XOR）运算。第一个分组则需要一个初始化向量(IV initialization vector)做异或运算。 每个分组依赖前一个分组像一个链条，因此得名。

CFB，OFB和CBC类似都需要IV，只是当前明文分组的处理方式不同。


************************

## 公钥密码
> 非对称加密

类比场景： 
- 对称加密，传统房门的锁需要同钥匙来开关门，则密钥是相同的：钥匙；
- 公钥加密：超市中的付费购物车，需要投币开锁，推入前一个购物车后完成加锁，则密钥是不同的，加锁密钥：前一个购物车，解锁密钥：硬币。



## 散列函数

## 消息认证码

## 数字签名
### 签名与验签
> 常见于外部接口的签名验证，安全防护

[企点： 消息加解密指引](https://api.qidian.qq.com/wiki/doc/open/epko939s7aq8br19gz0i)`对接企点API对消息的加解密`

## 证书

1. 基本概念：
    1. `CA (Certificate Authority)`  证书授权中心，是数字证书发放和管理的机构
    1. `根证书` 根证书是CA认证中心给自己颁发的证书,是信任链的起始点。安装根证书意味着对这个CA认证中心的信任。
    1. `数字证书` 数字证书颁发过程一般为：
        1. 用户首先产生自己的密钥对，并将公共密钥及部分个人身份信息传送给认证中心。
        1. 认证中心在核实身份后，将执行一些必要的步骤，以确信请求确实由用户发送而来。
        1. 认证中心将发给用户一个数字证书，该证书内包含用户的个人信息和他的公钥信息，同时还附有认证中心的签名信息。

- [Githhub:mkcert](https://github.com/FiloSottile/mkcert)`签发证书工具`

## 密钥

## 随机数

************************

# 集大成者
## PGP

## SSL TLS
> [SSL/TLS协议运行机制的概述](http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html)
> [SSL，TLS，HTTPS](https://www.cnblogs.com/songhan/archive/2012/08/01/2617970.html)

