---
title: å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€
date: 2018-11-21 10:56:52
tags: 
    - å‡½æ•°å¼ç¼–ç¨‹
categories:
    - åŸºç¡€
---

ğŸ’ 

- 1. [å‡½æ•°å¼ç¼–ç¨‹æ¦‚è¿°](#å‡½æ•°å¼ç¼–ç¨‹æ¦‚è¿°)
    - 1.1. [ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹](#ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹)
    - 1.2. [å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³](#å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³)
        - 1.2.1. [1. å‡½æ•°ä½œä¸ºä¸€ç­‰å…¬æ°‘](#1-å‡½æ•°ä½œä¸ºä¸€ç­‰å…¬æ°‘)
        - 1.2.2. [2. ä¸å¯å˜æ•°æ®](#2-ä¸å¯å˜æ•°æ®)
        - 1.2.3. [3. å£°æ˜å¼ç¼–ç¨‹é£æ ¼](#3-å£°æ˜å¼ç¼–ç¨‹é£æ ¼)
    - 1.3. [å‡½æ•°å¼ç¼–ç¨‹ vs é¢å‘å¯¹è±¡ç¼–ç¨‹](#å‡½æ•°å¼ç¼–ç¨‹-vs-é¢å‘å¯¹è±¡ç¼–ç¨‹)
        - 1.3.1. [ä¸»è¦åŒºåˆ«](#ä¸»è¦åŒºåˆ«)
        - 1.3.2. [å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿](#å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿)
        - 1.3.3. [ä½•æ—¶ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹](#ä½•æ—¶ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹)
- 2. [æ ¸å¿ƒæ¦‚å¿µä¸åŸåˆ™](#æ ¸å¿ƒæ¦‚å¿µä¸åŸåˆ™)
    - 2.1. [çº¯å‡½æ•° (Pure Functions)](#çº¯å‡½æ•°-pure-functions)
        - 2.1.1. [çº¯å‡½æ•°çš„ä¼˜åŠ¿](#çº¯å‡½æ•°çš„ä¼˜åŠ¿)
    - 2.2. [ä¸å¯å˜æ€§ (Immutability)](#ä¸å¯å˜æ€§-immutability)
        - 2.2.1. [ä¸ºä»€ä¹ˆéœ€è¦ä¸å¯å˜æ€§](#ä¸ºä»€ä¹ˆéœ€è¦ä¸å¯å˜æ€§)
        - 2.2.2. [å®ç°æ–¹å¼](#å®ç°æ–¹å¼)
    - 2.3. [é«˜é˜¶å‡½æ•° (Higher-Order Functions)](#é«˜é˜¶å‡½æ•°-higher-order-functions)
    - 2.4. [å‡½æ•°ç»„åˆ (Function Composition)](#å‡½æ•°ç»„åˆ-function-composition)
        - 2.4.1. [æ•°å­¦è¡¨ç¤º](#æ•°å­¦è¡¨ç¤º)
    - 2.5. [æŸ¯é‡ŒåŒ– (Currying)](#æŸ¯é‡ŒåŒ–-currying)
    - 2.6. [éƒ¨åˆ†åº”ç”¨ (Partial Application)](#éƒ¨åˆ†åº”ç”¨-partial-application)
        - 2.6.1. [ä¸æŸ¯é‡ŒåŒ–çš„åŒºåˆ«](#ä¸æŸ¯é‡ŒåŒ–çš„åŒºåˆ«)
- 3. [å¸¸è§å‡½æ•°å¼ç¼–ç¨‹æ¨¡å¼](#å¸¸è§å‡½æ•°å¼ç¼–ç¨‹æ¨¡å¼)
    - 3.1. [æ˜ å°„ (Map)](#æ˜ å°„-map)
        - 3.1.1. [æ•°å­¦è¡¨ç¤º](#æ•°å­¦è¡¨ç¤º)
    - 3.2. [è¿‡æ»¤ (Filter)](#è¿‡æ»¤-filter)
    - 3.3. [å½’çº¦ (Reduce/Fold)](#å½’çº¦-reducefold)
        - 3.3.1. [Reduce çš„å·¥ä½œåŸç†](#reduce-çš„å·¥ä½œåŸç†)
    - 3.4. [å…¶ä»–å¸¸ç”¨é«˜é˜¶å‡½æ•°](#å…¶ä»–å¸¸ç”¨é«˜é˜¶å‡½æ•°)
        - 3.4.1. [FlatMap](#flatmap)
        - 3.4.2. [TakeWhile / DropWhile](#takewhile--dropwhile)
        - 3.4.3. [ç»„åˆä½¿ç”¨](#ç»„åˆä½¿ç”¨)
- 4. [é€’å½’ä¸å°¾é€’å½’](#é€’å½’ä¸å°¾é€’å½’)
        - 4.0.1. [é€’å½’ç¤ºä¾‹](#é€’å½’ç¤ºä¾‹)
    - 4.1. [å°¾é€’å½’ä¼˜åŒ–](#å°¾é€’å½’ä¼˜åŒ–)
        - 4.1.1. [å°¾é€’å½’ç¤ºä¾‹](#å°¾é€’å½’ç¤ºä¾‹)
        - 4.1.2. [å°¾é€’å½’ä¼˜åŒ–åŸç†](#å°¾é€’å½’ä¼˜åŒ–åŸç†)
        - 4.1.3. [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
- 5. [Lambda è¡¨è¾¾å¼ä¸ Lambda æ¼”ç®—](#lambda-è¡¨è¾¾å¼ä¸-lambda-æ¼”ç®—)
    - 5.1. [Lambda æ¼”ç®—åŸºç¡€](#lambda-æ¼”ç®—åŸºç¡€)
        - 5.1.1. [Lambda æ¼”ç®—çš„ç»„æˆéƒ¨åˆ†](#lambda-æ¼”ç®—çš„ç»„æˆéƒ¨åˆ†)
        - 5.1.2. [Lambda è¡¨è¾¾å¼çš„åŸºæœ¬å½¢å¼](#lambda-è¡¨è¾¾å¼çš„åŸºæœ¬å½¢å¼)
        - 5.1.3. [Lambda æ¼”ç®—çš„åŸºæœ¬è§„åˆ™](#lambda-æ¼”ç®—çš„åŸºæœ¬è§„åˆ™)
    - 5.2. [Lambda è¡¨è¾¾å¼åœ¨ä¸åŒè¯­è¨€ä¸­çš„å®ç°](#lambda-è¡¨è¾¾å¼åœ¨ä¸åŒè¯­è¨€ä¸­çš„å®ç°)
        - 5.2.1. [Java 8+ Lambda è¡¨è¾¾å¼](#java-8+-lambda-è¡¨è¾¾å¼)
        - 5.2.2. [JavaScript Arrow Functions](#javascript-arrow-functions)
        - 5.2.3. [Python Lambda è¡¨è¾¾å¼](#python-lambda-è¡¨è¾¾å¼)
    - 5.3. [é—­åŒ… (Closure)](#é—­åŒ…-closure)
        - 5.3.1. [é—­åŒ…çš„æ ¸å¿ƒç‰¹å¾](#é—­åŒ…çš„æ ¸å¿ƒç‰¹å¾)
        - 5.3.2. [é—­åŒ…çš„å·¥ä½œåŸç†](#é—­åŒ…çš„å·¥ä½œåŸç†)
        - 5.3.3. [JavaScript ä¸­çš„é—­åŒ…ç¤ºä¾‹](#javascript-ä¸­çš„é—­åŒ…ç¤ºä¾‹)
        - 5.3.4. [Java ä¸­çš„é—­åŒ…](#java-ä¸­çš„é—­åŒ…)
        - 5.3.5. [Python ä¸­çš„é—­åŒ…](#python-ä¸­çš„é—­åŒ…)
        - 5.3.6. [é—­åŒ…çš„åº”ç”¨åœºæ™¯](#é—­åŒ…çš„åº”ç”¨åœºæ™¯)
        - 5.3.7. [é—­åŒ…ä¸ Lambda è¡¨è¾¾å¼çš„å…³ç³»](#é—­åŒ…ä¸-lambda-è¡¨è¾¾å¼çš„å…³ç³»)
        - 5.3.8. [é—­åŒ…çš„æ³¨æ„äº‹é¡¹](#é—­åŒ…çš„æ³¨æ„äº‹é¡¹)
        - 5.3.9. [é—­åŒ…çš„ä¼˜åŠ¿](#é—­åŒ…çš„ä¼˜åŠ¿)
- 6. [å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿ä¸åº”ç”¨](#å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿ä¸åº”ç”¨)
    - 6.1. [å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿](#å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿)
        - 6.1.1. [1. ä»£ç ç®€æ´æ€§](#1-ä»£ç ç®€æ´æ€§)
        - 6.1.2. [2. å¯æµ‹è¯•æ€§](#2-å¯æµ‹è¯•æ€§)
        - 6.1.3. [3. å¹¶å‘å®‰å…¨](#3-å¹¶å‘å®‰å…¨)
        - 6.1.4. [4. å¯ç»´æŠ¤æ€§](#4-å¯ç»´æŠ¤æ€§)
        - 6.1.5. [5. å¯ç»„åˆæ€§](#5-å¯ç»„åˆæ€§)
        - 6.1.6. [6. å£°æ˜å¼é£æ ¼](#6-å£°æ˜å¼é£æ ¼)
    - 6.2. [é€‚ç”¨åœºæ™¯](#é€‚ç”¨åœºæ™¯)
        - 6.2.1. [é€‚åˆä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„åœºæ™¯](#é€‚åˆä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„åœºæ™¯)
        - 6.2.2. [ä¸é€‚åˆä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„åœºæ™¯](#ä¸é€‚åˆä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„åœºæ™¯)
    - 6.3. [å‡½æ•°å¼ç¼–ç¨‹ä¸è®¾è®¡æ¨¡å¼](#å‡½æ•°å¼ç¼–ç¨‹ä¸è®¾è®¡æ¨¡å¼)
        - 6.3.1. [ä¼ ç»Ÿè®¾è®¡æ¨¡å¼ vs å‡½æ•°å¼ç¼–ç¨‹](#ä¼ ç»Ÿè®¾è®¡æ¨¡å¼-vs-å‡½æ•°å¼ç¼–ç¨‹)
- 7. [å®è·µç¤ºä¾‹](#å®è·µç¤ºä¾‹)
    - 7.1. [Java ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹](#java-ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹)
        - 7.1.1. [Stream API ä½¿ç”¨](#stream-api-ä½¿ç”¨)
        - 7.1.2. [Optional ä½¿ç”¨](#optional-ä½¿ç”¨)
        - 7.1.3. [å‡½æ•°å¼æ¥å£](#å‡½æ•°å¼æ¥å£)
    - 7.2. [JavaScript ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹](#javascript-ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹)
        - 7.2.1. [æ•°ç»„æ“ä½œ](#æ•°ç»„æ“ä½œ)
        - 7.2.2. [å‡½æ•°ç»„åˆ](#å‡½æ•°ç»„åˆ)
    - 7.3. [å®é™…åº”ç”¨æ¡ˆä¾‹](#å®é™…åº”ç”¨æ¡ˆä¾‹)
        - 7.3.1. [æ¡ˆä¾‹1ï¼šæ•°æ®å¤„ç†ç®¡é“](#æ¡ˆä¾‹1æ•°æ®å¤„ç†ç®¡é“)
        - 7.3.2. [æ¡ˆä¾‹2ï¼šå¼‚æ­¥å¤„ç†](#æ¡ˆä¾‹2å¼‚æ­¥å¤„ç†)
        - 7.3.3. [æ¡ˆä¾‹3ï¼šé…ç½®ç®¡ç†](#æ¡ˆä¾‹3é…ç½®ç®¡ç†)

ğŸ’  2025-12-16 17:49:42
****************************************
# å‡½æ•°å¼ç¼–ç¨‹æ¦‚è¿°

## ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹

å‡½æ•°å¼ç¼–ç¨‹ï¼ˆFunctional Programmingï¼ŒFPï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå®ƒå°†è®¡ç®—è§†ä¸ºæ•°å­¦å‡½æ•°çš„æ±‚å€¼ï¼Œå¹¶é¿å…æ”¹å˜çŠ¶æ€å’Œå¯å˜æ•°æ®ã€‚

> [ç å†œç¿»èº«:å‡½æ•°å¼ç¼–ç¨‹åœ£ç»](http://mp.weixin.qq.com/s/0gErQ3tjDLZuD1bYOhi0mQ)
> [è§£é“: é¢å‘å‡½æ•°èŒƒå¼ç¼–ç¨‹](https://www.jdon.com/functional.html)

- **å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘**ï¼šå‡½æ•°å¯ä»¥åƒå…¶ä»–æ•°æ®ç±»å‹ä¸€æ ·è¢«ä¼ é€’ã€èµ‹å€¼å’Œè¿”å›
- **å£°æ˜å¼ç¼–ç¨‹**ï¼šå…³æ³¨"åšä»€ä¹ˆ"è€Œä¸æ˜¯"æ€ä¹ˆåš"
- **é¿å…å‰¯ä½œç”¨**ï¼šå‡½æ•°åº”è¯¥åªä¾èµ–äºè¾“å…¥å‚æ•°ï¼Œä¸æ”¹å˜å¤–éƒ¨çŠ¶æ€
- **è¡¨è¾¾å¼æ±‚å€¼**ï¼šç¨‹åºç”±è¡¨è¾¾å¼ç»„æˆï¼Œè€Œä¸æ˜¯è¯­å¥åºåˆ—

## å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³

### 1. å‡½æ•°ä½œä¸ºä¸€ç­‰å…¬æ°‘

åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œå‡½æ•°å¯ä»¥ï¼š
- ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°
- ä½œä¸ºè¿”å›å€¼ä»å‡½æ•°ä¸­è¿”å›
- èµ‹å€¼ç»™å˜é‡
- å­˜å‚¨åœ¨æ•°æ®ç»“æ„ä¸­

### 2. ä¸å¯å˜æ•°æ®

æ•°æ®ä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½è¢«ä¿®æ”¹ï¼Œä»»ä½•"ä¿®æ”¹"æ“ä½œéƒ½ä¼šåˆ›å»ºæ–°çš„æ•°æ®å‰¯æœ¬ã€‚

### 3. å£°æ˜å¼ç¼–ç¨‹é£æ ¼

æè¿°é—®é¢˜çš„æœ¬è´¨ï¼Œè€Œä¸æ˜¯æè¿°è§£å†³é—®é¢˜çš„æ­¥éª¤ã€‚

**å‘½ä»¤å¼ï¼ˆå¦‚ä½•åšï¼‰**ï¼š
```java
List<Integer> result = new ArrayList<>();
for (int i = 0; i < numbers.size(); i++) {
    if (numbers.get(i) > 10) {
        result.add(numbers.get(i) * 2);
    }
}
```

**å£°æ˜å¼ï¼ˆåšä»€ä¹ˆï¼‰**ï¼š
```java
List<Integer> result = numbers.stream()
    .filter(n -> n > 10)
    .map(n -> n * 2)
    .collect(Collectors.toList());
```

## å‡½æ•°å¼ç¼–ç¨‹ vs é¢å‘å¯¹è±¡ç¼–ç¨‹

### ä¸»è¦åŒºåˆ«

| ç‰¹æ€§ | å‡½æ•°å¼ç¼–ç¨‹ | é¢å‘å¯¹è±¡ç¼–ç¨‹ |
|------|-----------|-------------|
| æ ¸å¿ƒæŠ½è±¡ | å‡½æ•° | å¯¹è±¡ |
| æ•°æ®çŠ¶æ€ | ä¸å¯å˜ | å¯å˜ |
| ç¼–ç¨‹é£æ ¼ | å£°æ˜å¼ | å‘½ä»¤å¼ |
| ä»£ç é‡ç”¨ | å‡½æ•°ç»„åˆ | ç»§æ‰¿/ç»„åˆ |
| å¹¶å‘å¤„ç† | å¤©ç„¶å®‰å…¨ | éœ€è¦åŒæ­¥æœºåˆ¶ |

### å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿

- **é¢å‘å¯¹è±¡çš„ä¸»è¦é™åˆ¶**ï¼šä¸èƒ½åœ¨ç°æœ‰æ–¹æ³•ä¸Šå¢åŠ é¢å¤–çš„é€»è¾‘
- **å‡½æ•°å¼çš„è§£å†³æ–¹æ¡ˆ**ï¼šå°†æ–¹æ³•ï¼ˆå‡½æ•°ï¼‰ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œç„¶åæ‰©å±•é€»è¾‘
- **ä¸AOPçš„åŒºåˆ«**ï¼šAOPæ˜¯é‡å‹çš„åŸºäºåŠ¨æ€ä»£ç†ç±»å»å°è£…æ‰©å±•åŸæ–¹æ³•ï¼Œè€Œå‡½æ•°å¼ç¼–ç¨‹æ›´åŠ è½»é‡å’Œçµæ´»

### ä½•æ—¶ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹

- æ•°æ®å¤„ç†å’Œè½¬æ¢
- å¹¶å‘å’Œå¹¶è¡Œç¼–ç¨‹
- æ•°å­¦è®¡ç®—å’Œç®—æ³•
- äº‹ä»¶å¤„ç†å’Œå¼‚æ­¥ç¼–ç¨‹
- é…ç½®å’Œç­–ç•¥æ¨¡å¼

---

# æ ¸å¿ƒæ¦‚å¿µä¸åŸåˆ™

## çº¯å‡½æ•° (Pure Functions)

> å®šä¹‰

çº¯å‡½æ•°æ˜¯æŒ‡æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„å‡½æ•°ï¼š
1. **ç›¸åŒè¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒè¾“å‡º**ï¼ˆç¡®å®šæ€§ï¼‰
2. **æ²¡æœ‰å‰¯ä½œç”¨**ï¼ˆä¸ä¿®æ”¹å¤–éƒ¨çŠ¶æ€ã€ä¸è¿›è¡ŒIOæ“ä½œç­‰ï¼‰

> ç¤ºä¾‹

**çº¯å‡½æ•°**ï¼š
```java
// çº¯å‡½æ•°ï¼šç›¸åŒè¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒè¾“å‡ºï¼Œæ— å‰¯ä½œç”¨
public static int add(int a, int b) {
    return a + b;
}

public static int square(int x) {
    return x * x;
}
```

**éçº¯å‡½æ•°**ï¼š
```java
// éçº¯å‡½æ•°ï¼šæœ‰å‰¯ä½œç”¨ï¼ˆä¿®æ”¹å¤–éƒ¨å˜é‡ï¼‰
private int counter = 0;
public int increment() {
    return ++counter; // å‰¯ä½œç”¨ï¼šä¿®æ”¹äº†å¤–éƒ¨çŠ¶æ€
}

// éçº¯å‡½æ•°ï¼šä¾èµ–å¤–éƒ¨çŠ¶æ€
public int getCurrentTime() {
    return System.currentTimeMillis(); // æ¯æ¬¡è°ƒç”¨ç»“æœä¸åŒ
}
```

### çº¯å‡½æ•°çš„ä¼˜åŠ¿

- **å¯æµ‹è¯•æ€§**ï¼šæ˜“äºå•å…ƒæµ‹è¯•
- **å¯é¢„æµ‹æ€§**ï¼šè¡Œä¸ºå¯é¢„æµ‹
- **å¯ç¼“å­˜**ï¼šå¯ä»¥ç¼“å­˜ç»“æœ
- **å¯å¹¶è¡ŒåŒ–**ï¼šå¤©ç„¶çº¿ç¨‹å®‰å…¨
- **æ˜“äºæ¨ç†**ï¼šä»£ç æ›´å®¹æ˜“ç†è§£

## ä¸å¯å˜æ€§ (Immutability)

> æ¦‚å¿µ

ä¸å¯å˜æ€§æ˜¯æŒ‡æ•°æ®ä¸€æ—¦åˆ›å»ºå°±ä¸èƒ½è¢«ä¿®æ”¹ã€‚ä»»ä½•"ä¿®æ”¹"æ“ä½œéƒ½ä¼šåˆ›å»ºæ–°çš„æ•°æ®å‰¯æœ¬ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦ä¸å¯å˜æ€§

1. **çº¿ç¨‹å®‰å…¨**ï¼šä¸å¯å˜å¯¹è±¡å¤©ç„¶çº¿ç¨‹å®‰å…¨
2. **é¿å…æ„å¤–ä¿®æ”¹**ï¼šé˜²æ­¢æ•°æ®è¢«æ„å¤–æ”¹å˜
3. **æ˜“äºæ¨ç†**ï¼šä¸éœ€è¦è¿½è¸ªçŠ¶æ€å˜åŒ–
4. **æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹**ï¼šçº¯å‡½æ•°éœ€è¦ä¸å¯å˜æ•°æ®

### å®ç°æ–¹å¼

**å¯å˜å¯¹è±¡**ï¼š
```java
List<String> list = new ArrayList<>();
list.add("item1"); // ä¿®æ”¹äº†åŸå¯¹è±¡
list.add("item2");
```

**ä¸å¯å˜å¯¹è±¡**ï¼š
```java
// Java 9+ ä¸å¯å˜åˆ—è¡¨
List<String> list = List.of("item1", "item2");

// åˆ›å»ºæ–°å¯¹è±¡è€Œä¸æ˜¯ä¿®æ”¹åŸå¯¹è±¡
List<String> newList = new ArrayList<>(list);
newList.add("item3");
```

## é«˜é˜¶å‡½æ•° (Higher-Order Functions)

> å®šä¹‰

é«˜é˜¶å‡½æ•°æ˜¯æŒ‡ï¼š
- æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°çš„å‡½æ•°
- è¿”å›å‡½æ•°çš„å‡½æ•°
- æˆ–è€…ä¸¤è€…å…¼è€Œæœ‰ä¹‹

> ç¤ºä¾‹

```java
// æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°
public static <T, R> List<R> map(List<T> list, Function<T, R> mapper) {
    List<R> result = new ArrayList<>();
    for (T item : list) {
        result.add(mapper.apply(item));
    }
    return result;
}

// è¿”å›å‡½æ•°
public static Function<Integer, Integer> multiplyBy(int factor) {
    return x -> x * factor;
}

// ä½¿ç”¨
Function<Integer, Integer> multiplyBy5 = multiplyBy(5);
int result = multiplyBy5.apply(10); // 50
```

## å‡½æ•°ç»„åˆ (Function Composition)

> æ¦‚å¿µ

å‡½æ•°ç»„åˆæ˜¯å°†å¤šä¸ªå‡½æ•°ç»„åˆæˆä¸€ä¸ªæ–°å‡½æ•°çš„è¿‡ç¨‹ã€‚æ–°å‡½æ•°çš„è¾“å‡ºæ˜¯å‰ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥ã€‚

### æ•°å­¦è¡¨ç¤º

å¦‚æœ `f: A -> B` å’Œ `g: B -> C`ï¼Œé‚£ä¹ˆ `g âˆ˜ f: A -> C`

> ç¤ºä¾‹

```java
// Java ä¸­çš„å‡½æ•°ç»„åˆ
Function<Integer, Integer> addOne = x -> x + 1;
Function<Integer, Integer> multiplyByTwo = x -> x * 2;

// ç»„åˆï¼šå…ˆåŠ 1ï¼Œå†ä¹˜ä»¥2
Function<Integer, Integer> composed = addOne.andThen(multiplyByTwo);
int result = composed.apply(5); // (5 + 1) * 2 = 12

// æˆ–è€…ï¼šå…ˆä¹˜ä»¥2ï¼Œå†åŠ 1
Function<Integer, Integer> composed2 = multiplyByTwo.andThen(addOne);
int result2 = composed2.apply(5); // (5 * 2) + 1 = 11
```

> ä¼˜åŠ¿

- **ä»£ç å¤ç”¨**ï¼šé€šè¿‡ç»„åˆå°å‡½æ•°æ„å»ºå¤æ‚åŠŸèƒ½
- **å¯è¯»æ€§**ï¼šä»£ç æ›´æ¸…æ™°ï¼Œè¡¨è¾¾æ„å›¾æ›´æ˜ç¡®
- **æ¨¡å—åŒ–**ï¼šæ¯ä¸ªå‡½æ•°èŒè´£å•ä¸€

## æŸ¯é‡ŒåŒ– (Currying)

> å®šä¹‰

æŸ¯é‡ŒåŒ–æ˜¯å°†æ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢ä¸ºæ¥å—å•ä¸ªå‚æ•°å¹¶è¿”å›æ¥å—ä¸‹ä¸€ä¸ªå‚æ•°çš„å‡½æ•°çš„è¿‡ç¨‹ã€‚

> ç¤ºä¾‹

**æ™®é€šå‡½æ•°**ï¼š
```java
// æ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°
Function<Integer, Function<Integer, Integer>> add = a -> b -> a + b;

// ä½¿ç”¨
int result = add.apply(5).apply(3); // 8
```

**æ›´å®é™…çš„ä¾‹å­**ï¼š
```java
// æŸ¯é‡ŒåŒ–çš„ä¹˜æ³•å‡½æ•°
Function<Integer, Function<Integer, Integer>> multiply = a -> b -> a * b;

// éƒ¨åˆ†åº”ç”¨ï¼šåˆ›å»ºä¹˜ä»¥10çš„å‡½æ•°
Function<Integer, Integer> multiplyBy10 = multiply.apply(10);
int result = multiplyBy10.apply(5); // 50
```

> ä¼˜åŠ¿

- **éƒ¨åˆ†åº”ç”¨**ï¼šå¯ä»¥é¢„å…ˆè®¾ç½®ä¸€äº›å‚æ•°
- **å‡½æ•°å¤ç”¨**ï¼šåˆ›å»ºæ›´é€šç”¨çš„å‡½æ•°
- **å»¶è¿Ÿæ±‚å€¼**ï¼šå¯ä»¥å»¶è¿Ÿå‡½æ•°çš„æ‰§è¡Œ

## éƒ¨åˆ†åº”ç”¨ (Partial Application)

> å®šä¹‰

éƒ¨åˆ†åº”ç”¨æ˜¯å›ºå®šå‡½æ•°çš„ä¸€äº›å‚æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ¥å—æ›´å°‘å‚æ•°çš„æ–°å‡½æ•°ã€‚

### ä¸æŸ¯é‡ŒåŒ–çš„åŒºåˆ«

- **æŸ¯é‡ŒåŒ–**ï¼šæ¯æ¬¡åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°å‡½æ•°
- **éƒ¨åˆ†åº”ç”¨**ï¼šå¯ä»¥ä¸€æ¬¡å›ºå®šå¤šä¸ªå‚æ•°

> ç¤ºä¾‹

```java
// åŸå§‹å‡½æ•°
BiFunction<Integer, Integer, Integer> add = (a, b) -> a + b;

// éƒ¨åˆ†åº”ç”¨ï¼šå›ºå®šç¬¬ä¸€ä¸ªå‚æ•°ä¸º10
Function<Integer, Integer> add10 = b -> add.apply(10, b);
int result = add10.apply(5); // 15
```

---

# å¸¸è§å‡½æ•°å¼ç¼–ç¨‹æ¨¡å¼

## æ˜ å°„ (Map)

> æ¦‚å¿µ

`map` å‡½æ•°å°†é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ é€šè¿‡ç»™å®šçš„å‡½æ•°è¿›è¡Œè½¬æ¢ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„é›†åˆã€‚

### æ•°å­¦è¡¨ç¤º

`map(f, [x1, x2, ..., xn]) = [f(x1), f(x2), ..., f(xn)]`

> ç¤ºä¾‹

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);

// å°†æ¯ä¸ªæ•°å­—å¹³æ–¹
List<Integer> squares = numbers.stream()
    .map(n -> n * n)
    .collect(Collectors.toList());
// ç»“æœ: [1, 4, 9, 16, 25]

// å°†æ•°å­—è½¬æ¢ä¸ºå­—ç¬¦ä¸²
List<String> strings = numbers.stream()
    .map(n -> "Number: " + n)
    .collect(Collectors.toList());
```

## è¿‡æ»¤ (Filter)

> æ¦‚å¿µ

`filter` å‡½æ•°æ ¹æ®ç»™å®šçš„è°“è¯ï¼ˆæ¡ä»¶ï¼‰è¿‡æ»¤é›†åˆä¸­çš„å…ƒç´ ï¼Œè¿”å›æ»¡è¶³æ¡ä»¶çš„æ–°é›†åˆã€‚

> ç¤ºä¾‹

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

// è¿‡æ»¤å‡ºå¶æ•°
List<Integer> evens = numbers.stream()
    .filter(n -> n % 2 == 0)
    .collect(Collectors.toList());
// ç»“æœ: [2, 4, 6, 8, 10]

// è¿‡æ»¤å‡ºå¤§äº5çš„æ•°
List<Integer> greaterThan5 = numbers.stream()
    .filter(n -> n > 5)
    .collect(Collectors.toList());
// ç»“æœ: [6, 7, 8, 9, 10]
```

## å½’çº¦ (Reduce/Fold)

> æ¦‚å¿µ

`reduce`ï¼ˆä¹Ÿç§°ä¸º `fold`ï¼‰å‡½æ•°å°†é›†åˆå½’çº¦ä¸ºå•ä¸ªå€¼ï¼Œé€šè¿‡ç´¯ç§¯å‡½æ•°é€æ­¥å¤„ç†æ¯ä¸ªå…ƒç´ ã€‚

> ç¤ºä¾‹

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);

// æ±‚å’Œ
int sum = numbers.stream()
    .reduce(0, (a, b) -> a + b);
// ç»“æœ: 15

// æ±‚æœ€å¤§å€¼
int max = numbers.stream()
    .reduce(Integer.MIN_VALUE, Integer::max);
// ç»“æœ: 5

// æ±‚ä¹˜ç§¯
int product = numbers.stream()
    .reduce(1, (a, b) -> a * b);
// ç»“æœ: 120
```

### Reduce çš„å·¥ä½œåŸç†

```
åˆå§‹å€¼: 0
[1, 2, 3, 4, 5]
  â†“
0 + 1 = 1
  â†“
1 + 2 = 3
  â†“
3 + 3 = 6
  â†“
6 + 4 = 10
  â†“
10 + 5 = 15
```

## å…¶ä»–å¸¸ç”¨é«˜é˜¶å‡½æ•°

### FlatMap

å°†åµŒå¥—é›†åˆå±•å¹³å¹¶æ˜ å°„ï¼š

```java
List<List<Integer>> nested = Arrays.asList(
    Arrays.asList(1, 2),
    Arrays.asList(3, 4),
    Arrays.asList(5, 6)
);

List<Integer> flattened = nested.stream()
    .flatMap(List::stream)
    .collect(Collectors.toList());
// ç»“æœ: [1, 2, 3, 4, 5, 6]
```

### TakeWhile / DropWhile

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8);

// å–æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³çš„
List<Integer> taken = numbers.stream()
    .takeWhile(n -> n < 5)
    .collect(Collectors.toList());
// ç»“æœ: [1, 2, 3, 4]

// è·³è¿‡æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³çš„
List<Integer> dropped = numbers.stream()
    .dropWhile(n -> n < 5)
    .collect(Collectors.toList());
// ç»“æœ: [5, 6, 7, 8]
```

### ç»„åˆä½¿ç”¨

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

// è¿‡æ»¤å¶æ•° -> å¹³æ–¹ -> æ±‚å’Œ
int result = numbers.stream()
    .filter(n -> n % 2 == 0)      // [2, 4, 6, 8, 10]
    .map(n -> n * n)               // [4, 16, 36, 64, 100]
    .reduce(0, Integer::sum);      // 220
```

---

# é€’å½’ä¸å°¾é€’å½’
åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œé€’å½’æ˜¯æ§åˆ¶æµç¨‹çš„ä¸»è¦æ–¹å¼ï¼Œå› ä¸ºï¼š
- å‡½æ•°å¼ç¼–ç¨‹é¿å…ä½¿ç”¨å¯å˜çŠ¶æ€ï¼Œå¾ªç¯é€šå¸¸éœ€è¦å¯å˜è®¡æ•°å™¨
- é€’å½’æ›´ç¬¦åˆæ•°å­¦æ€ç»´ï¼Œè¡¨è¾¾ç®—æ³•æ›´è‡ªç„¶
- é€’å½’å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨ä¸å¯å˜æ•°æ®ç»“æ„

> é€’å½’ vs å¾ªç¯

**éå‡½æ•°å¼è¯­è¨€**ï¼šå°½é‡ä½¿ç”¨å¾ªç¯è€Œä¸æ˜¯é€’å½’ï¼ˆé¿å…æ ˆæº¢å‡ºï¼‰
**å‡½æ•°å¼è¯­è¨€**ï¼šä½¿ç”¨é€’å½’è€Œä¸æ˜¯å¾ªç¯ï¼ˆæœ‰å°¾é€’å½’ä¼˜åŒ–ï¼‰

### é€’å½’ç¤ºä¾‹

**é˜¶ä¹˜å‡½æ•°ï¼ˆæ™®é€šé€’å½’ï¼‰**ï¼š
```java
public static int factorial(int n) {
    if (n <= 1) {
        return 1;
    }
    return n * factorial(n - 1);
}
```

**æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆæ™®é€šé€’å½’ï¼‰**ï¼š
```java
public static int fibonacci(int n) {
    if (n <= 1) {
        return n;
    }
    return fibonacci(n - 1) + fibonacci(n - 2);
}
```

## å°¾é€’å½’ä¼˜åŒ–
å°¾é€’å½’æ˜¯æŒ‡é€’å½’è°ƒç”¨æ˜¯å‡½æ•°çš„æœ€åä¸€ä¸ªæ“ä½œï¼Œä¸”è¿”å›å€¼ç›´æ¥è¿”å›é€’å½’è°ƒç”¨çš„ç»“æœã€‚

> å°¾é€’å½’çš„ä¼˜åŠ¿

å°¾é€’å½’å¯ä»¥å°†å½“å‰è¿è¡Œæ ˆè¦†ç›–ä¸Šä¸€ä¸ªè¿è¡Œæ ˆï¼Œè€Œä¸æ˜¯æ–°å¢ä¸€ä¸ªæ ˆå¸§ï¼Œä»è€Œå‡å°‘æ ˆçš„å ç”¨ï¼Œé¿å…æ ˆæº¢å‡ºã€‚

### å°¾é€’å½’ç¤ºä¾‹

**é˜¶ä¹˜å‡½æ•°ï¼ˆå°¾é€’å½’ç‰ˆæœ¬ï¼‰**ï¼š
```java
public static int factorialTailRec(int n) {
    return factorialHelper(n, 1);
}

private static int factorialHelper(int n, int acc) {
    if (n <= 1) {
        return acc;
    }
    return factorialHelper(n - 1, n * acc); // å°¾é€’å½’è°ƒç”¨
}
```

**æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆå°¾é€’å½’ç‰ˆæœ¬ï¼‰**ï¼š
```java
public static int fibonacciTailRec(int n) {
    return fibonacciHelper(n, 0, 1);
}

private static int fibonacciHelper(int n, int a, int b) {
    if (n == 0) {
        return a;
    }
    if (n == 1) {
        return b;
    }
    return fibonacciHelper(n - 1, b, a + b); // å°¾é€’å½’è°ƒç”¨
}
```

### å°¾é€’å½’ä¼˜åŒ–åŸç†

**æ™®é€šé€’å½’**ï¼ˆæ¯æ¬¡è°ƒç”¨åˆ›å»ºæ–°æ ˆå¸§ï¼‰ï¼š
```
factorial(5)
  â†’ 5 * factorial(4)
    â†’ 4 * factorial(3)
      â†’ 3 * factorial(2)
        â†’ 2 * factorial(1)
          â†’ 1
```

**å°¾é€’å½’**ï¼ˆå¯ä»¥å¤ç”¨æ ˆå¸§ï¼‰ï¼š
```
factorialHelper(5, 1)
  â†’ factorialHelper(4, 5)
    â†’ factorialHelper(3, 20)
      â†’ factorialHelper(2, 60)
        â†’ factorialHelper(1, 120)
          â†’ 120
```

### æ³¨æ„äº‹é¡¹

- **Java ä¸æ”¯æŒå°¾é€’å½’ä¼˜åŒ–**ï¼šè™½ç„¶å¯ä»¥å†™æˆå°¾é€’å½’å½¢å¼ï¼Œä½† JVM ä¸ä¼šè‡ªåŠ¨ä¼˜åŒ–
- **Scala æ”¯æŒå°¾é€’å½’ä¼˜åŒ–**ï¼šä½¿ç”¨ `@tailrec` æ³¨è§£
- **JavaScript (ES6)**ï¼šåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æ”¯æŒå°¾é€’å½’ä¼˜åŒ–
- **é€’å½’è½¬å¾ªç¯**ï¼šå¯ä»¥å°†å°¾é€’å½’æ‰‹åŠ¨è½¬æ¢ä¸ºå¾ªç¯

> ç›¸å…³èµ„æº

- [ç å†œç¿»èº«:å¼ å¤§èƒ–å­¦é€’å½’](http://mp.weixin.qq.com/s/YpG9TvTCBus2FK6LbArvvw)
- [æ·±å…¥äº†è§£å°¾é€’å½’](https://segmentfault.com/a/1190000007641519)
- [é¢è¯•é¢˜å…³äºé€’å½’çš„å±‚å±‚ä¼˜åŒ–](https://zhuanlan.zhihu.com/p/24283256)
- [é€’å½’åŒ–å¾ªç¯](http://www.cnblogs.com/JeffreyZhao/archive/2009/04/01/tail-recursion-explanation.html)

************************

# Lambda è¡¨è¾¾å¼ä¸ Lambda æ¼”ç®—

## Lambda æ¼”ç®—åŸºç¡€

> [Lambda æ¼”ç®—](https://klose911.github.io/html/theory/lambda.html)

Î» æ¼”ç®—å¯çœ‹åšæ˜¯ä¸€ä¸ªç®€å•çš„è¯­ä¹‰æ¸…æ¥šçš„å½¢å¼è¯­è¨€ï¼Œç”¨æ¥è§£é‡Šå¤æ‚çš„ç¨‹åºè®¾è®¡è¯­è¨€æˆ–è€…è®¡ç®—æ¨¡å‹ã€‚

### Lambda æ¼”ç®—çš„ç»„æˆéƒ¨åˆ†

Î» æ¼”ç®—é€šå¸¸åŒ…å«ä¸¤éƒ¨åˆ†ï¼š
- **è¯­æ³•**ï¼šåˆæ³•è¡¨è¾¾å¼ï¼ˆÎ»è¡¨è¾¾å¼ï¼‰çš„å½¢å¼ç³»ç»Ÿ
- **è¯­ä¹‰**ï¼šå˜æ¢è§„åˆ™çš„å½¢å¼ç³»ç»Ÿ

### Lambda è¡¨è¾¾å¼çš„åŸºæœ¬å½¢å¼

```
Î»x. M
```

å…¶ä¸­ï¼š
- `Î»` æ˜¯ lambda ç¬¦å·
- `x` æ˜¯å‚æ•°
- `.` åˆ†éš”å‚æ•°å’Œå‡½æ•°ä½“
- `M` æ˜¯å‡½æ•°ä½“

### Lambda æ¼”ç®—çš„åŸºæœ¬è§„åˆ™

1. **å˜é‡**ï¼š`x` æ˜¯ä¸€ä¸ªå˜é‡
2. **æŠ½è±¡**ï¼š`Î»x.M` æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—å‚æ•° `x`ï¼Œè¿”å› `M`
3. **åº”ç”¨**ï¼š`(M N)` è¡¨ç¤ºå°†å‡½æ•° `M` åº”ç”¨äºå‚æ•° `N`

> ç¤ºä¾‹

```
Î»x. x          // æ’ç­‰å‡½æ•°
Î»x. y          // å¸¸é‡å‡½æ•°ï¼ˆè¿”å› yï¼‰
Î»x. Î»y. x      // è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°çš„å‡½æ•°
Î»x. Î»y. y      // è¿”å›ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°
(Î»x. x) y      // åº”ç”¨ï¼šç»“æœæ˜¯ y
```

## Lambda è¡¨è¾¾å¼åœ¨ä¸åŒè¯­è¨€ä¸­çš„å®ç°

### Java 8+ Lambda è¡¨è¾¾å¼

```java
// æ— å‚æ•°
Runnable r = () -> System.out.println("Hello");

// å•ä¸ªå‚æ•°
Function<Integer, Integer> square = x -> x * x;

// å¤šä¸ªå‚æ•°
BiFunction<Integer, Integer, Integer> add = (a, b) -> a + b;

// æ–¹æ³•å¼•ç”¨
Function<String, Integer> parseInt = Integer::parseInt;
```

### JavaScript Arrow Functions

```javascript
// æ— å‚æ•°
const greet = () => console.log("Hello");

// å•ä¸ªå‚æ•°
const square = x => x * x;

// å¤šä¸ªå‚æ•°
const add = (a, b) => a + b;

// å¤šè¡Œå‡½æ•°ä½“
const process = (x) => {
    const doubled = x * 2;
    return doubled + 1;
};
```

### Python Lambda è¡¨è¾¾å¼

```python
# å•ä¸ªå‚æ•°
square = lambda x: x * x

# å¤šä¸ªå‚æ•°
add = lambda a, b: a + b

# åœ¨å‡½æ•°ä¸­ä½¿ç”¨
numbers = [1, 2, 3, 4, 5]
squares = list(map(lambda x: x * x, numbers))
```

************************


## é—­åŒ… (Closure)

é—­åŒ…æ˜¯æŒ‡ä¸€ä¸ªå‡½æ•°èƒ½å¤Ÿè®¿é—®å…¶å¤–éƒ¨ï¼ˆè¯æ³•ï¼‰ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œå³ä½¿è¯¥å‡½æ•°åœ¨å…¶å¤–éƒ¨ä½œç”¨åŸŸä¹‹å¤–è¢«è°ƒç”¨ã€‚

### é—­åŒ…çš„æ ¸å¿ƒç‰¹å¾

1. **å‡½æ•°åµŒå¥—**ï¼šå‡½æ•°å®šä¹‰åœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨
2. **è®¿é—®å¤–éƒ¨å˜é‡**ï¼šå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡
3. **å˜é‡æŒä¹…åŒ–**ï¼šå¤–éƒ¨å‡½æ•°çš„å˜é‡åœ¨å¤–éƒ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åä»ç„¶å­˜åœ¨ï¼Œè¢«å†…éƒ¨å‡½æ•°å¼•ç”¨

### é—­åŒ…çš„å·¥ä½œåŸç†

å½“å†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å‡½æ•°çš„å˜é‡æ—¶ï¼Œè¿™äº›å˜é‡ä¼šè¢«"æ•è·"å¹¶ä¿å­˜åœ¨é—­åŒ…ä¸­ï¼Œå³ä½¿å¤–éƒ¨å‡½æ•°å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œè¿™äº›å˜é‡ä»ç„¶å¯ä»¥è¢«å†…éƒ¨å‡½æ•°è®¿é—®ã€‚

### JavaScript ä¸­çš„é—­åŒ…ç¤ºä¾‹

**åŸºæœ¬ç¤ºä¾‹**ï¼š
```javascript
function outerFunction(x) {
    // å¤–éƒ¨å‡½æ•°çš„å˜é‡
    const outerVariable = x;
    
    // å†…éƒ¨å‡½æ•°ï¼ˆé—­åŒ…ï¼‰
    function innerFunction(y) {
        // è®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡
        return outerVariable + y;
    }
    
    return innerFunction;
}

// åˆ›å»ºé—­åŒ…
const closure = outerFunction(10);
console.log(closure(5)); // 15
// outerFunction å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œä½† outerVariable ä»ç„¶å¯ä»¥è¢«è®¿é—®
```

**ç»å…¸ç¤ºä¾‹ï¼šè®¡æ•°å™¨**ï¼š
```javascript
function createCounter() {
    let count = 0; // ç§æœ‰å˜é‡
    
    return function() {
        count++; // è®¿é—®å¤–éƒ¨å˜é‡
        return count;
    };
}

const counter1 = createCounter();
const counter2 = createCounter();

console.log(counter1()); // 1
console.log(counter1()); // 2
console.log(counter2()); // 1 (ç‹¬ç«‹çš„é—­åŒ…)
console.log(counter1()); // 3
```

**å¾ªç¯ä¸­çš„é—­åŒ…é—®é¢˜**ï¼š
```javascript
// é—®é¢˜ï¼šæ‰€æœ‰å‡½æ•°éƒ½å¼•ç”¨åŒä¸€ä¸ª i
for (var i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log(i); // è¾“å‡º: 3, 3, 3
    }, 100);
}

// è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨ letï¼ˆå—ä½œç”¨åŸŸï¼‰
for (let i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log(i); // è¾“å‡º: 0, 1, 2
    }, 100);
}

// è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨ IIFEï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼‰
for (var i = 0; i < 3; i++) {
    (function(j) {
        setTimeout(function() {
            console.log(j); // è¾“å‡º: 0, 1, 2
        }, 100);
    })(i);
}
```

### Java ä¸­çš„é—­åŒ…

Java 8+ çš„ Lambda è¡¨è¾¾å¼å’ŒåŒ¿åå†…éƒ¨ç±»å¯ä»¥å½¢æˆé—­åŒ…ï¼š

```java
// Lambda è¡¨è¾¾å¼é—­åŒ…
public static Function<Integer, Integer> createMultiplier(int factor) {
    // factor è¢«æ•è·åˆ°é—­åŒ…ä¸­
    return x -> x * factor;
}

// ä½¿ç”¨
Function<Integer, Integer> multiplyBy5 = createMultiplier(5);
int result = multiplyBy5.apply(10); // 50

// åŒ¿åå†…éƒ¨ç±»é—­åŒ…
public static Runnable createCounter() {
    final int[] count = {0}; // å¿…é¡»æ˜¯ final æˆ– effectively final
    
    return new Runnable() {
        @Override
        public void run() {
            count[0]++; // è®¿é—®å¤–éƒ¨å˜é‡
            System.out.println(count[0]);
        }
    };
}
```

**Java é—­åŒ…çš„é™åˆ¶**ï¼š
- Lambda è¡¨è¾¾å¼åªèƒ½è®¿é—® `final` æˆ– `effectively final` çš„å˜é‡
- ä¸èƒ½ä¿®æ”¹å¤–éƒ¨å˜é‡çš„å€¼ï¼ˆä½†å¯ä»¥ä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€ï¼‰

```java
// é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹å¤–éƒ¨å˜é‡
int count = 0;
Runnable r = () -> count++; // ç¼–è¯‘é”™è¯¯

// æ­£ç¡®ï¼šä½¿ç”¨æ•°ç»„æˆ–å¯¹è±¡åŒ…è£…
int[] count = {0};
Runnable r = () -> count[0]++; // å¯ä»¥ä¿®æ”¹æ•°ç»„å…ƒç´ 

// æˆ–è€…ä½¿ç”¨ AtomicInteger
AtomicInteger count = new AtomicInteger(0);
Runnable r = () -> count.incrementAndGet();
```

### Python ä¸­çš„é—­åŒ…

```python
def outer_function(x):
    # å¤–éƒ¨å‡½æ•°çš„å˜é‡
    outer_var = x
    
    def inner_function(y):
        # è®¿é—®å¤–éƒ¨å‡½æ•°çš„å˜é‡
        return outer_var + y
    
    return inner_function

# åˆ›å»ºé—­åŒ…
closure = outer_function(10)
print(closure(5))  # 15

# è®¡æ•°å™¨ç¤ºä¾‹
def create_counter():
    count = 0
    
    def counter():
        nonlocal count  # å…è®¸ä¿®æ”¹å¤–éƒ¨å˜é‡
        count += 1
        return count
    
    return counter

counter1 = create_counter()
counter2 = create_counter()

print(counter1())  # 1
print(counter1())  # 2
print(counter2())  # 1
```

### é—­åŒ…çš„åº”ç”¨åœºæ™¯

1. **æ•°æ®å°è£…å’Œç§æœ‰å˜é‡**
   ```javascript
   function createBankAccount(initialBalance) {
       let balance = initialBalance; // ç§æœ‰å˜é‡
       
       return {
           deposit: function(amount) {
               balance += amount;
               return balance;
           },
           withdraw: function(amount) {
               if (amount <= balance) {
                   balance -= amount;
                   return balance;
               }
               return "Insufficient funds";
           },
           getBalance: function() {
               return balance;
           }
       };
   }
   
   const account = createBankAccount(100);
   account.deposit(50);  // 150
   account.withdraw(30); // 120
   ```

2. **å‡½æ•°å·¥å‚**
   ```javascript
   function createValidator(min, max) {
       return function(value) {
           return value >= min && value <= max;
       };
   }
   
   const ageValidator = createValidator(18, 65);
   const scoreValidator = createValidator(0, 100);
   ```

3. **å›è°ƒå‡½æ•°å’Œäº‹ä»¶å¤„ç†**
   ```javascript
   function setupButton(buttonId, message) {
       const button = document.getElementById(buttonId);
       button.addEventListener('click', function() {
           // é—­åŒ…æ•è·äº† message
           alert(message);
       });
   }
   ```

4. **æ¨¡å—æ¨¡å¼**
   ```javascript
   const myModule = (function() {
       let privateVar = 0;
       
       return {
           increment: function() {
               privateVar++;
           },
           getValue: function() {
               return privateVar;
           }
       };
   })();
   ```

### é—­åŒ…ä¸ Lambda è¡¨è¾¾å¼çš„å…³ç³»

- **Lambda è¡¨è¾¾å¼**ï¼šåŒ¿åå‡½æ•°çš„è¯­æ³•ç³–
- **é—­åŒ…**ï¼šå‡½æ•°æ•è·å¤–éƒ¨å˜é‡çš„æœºåˆ¶

Lambda è¡¨è¾¾å¼ç»å¸¸å½¢æˆé—­åŒ…ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥è®¿é—®å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡ï¼š

```java
int factor = 10;
Function<Integer, Integer> multiplier = x -> x * factor; // Lambda + é—­åŒ…
```

### é—­åŒ…çš„æ³¨æ„äº‹é¡¹

1. **å†…å­˜æ³„æ¼é£é™©**ï¼šé—­åŒ…ä¼šä¿æŒå¯¹å¤–éƒ¨å˜é‡çš„å¼•ç”¨ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜æ— æ³•é‡Šæ”¾
2. **æ€§èƒ½è€ƒè™‘**ï¼šé—­åŒ…ä¼šå ç”¨é¢å¤–çš„å†…å­˜æ¥å­˜å‚¨æ•è·çš„å˜é‡
3. **å˜é‡å…±äº«**ï¼šå¤šä¸ªé—­åŒ…å¯èƒ½å…±äº«åŒä¸€ä¸ªå¤–éƒ¨å˜é‡

### é—­åŒ…çš„ä¼˜åŠ¿

- **æ•°æ®å°è£…**ï¼šåˆ›å»ºç§æœ‰å˜é‡
- **å‡½æ•°å·¥å‚**ï¼šåŠ¨æ€åˆ›å»ºå‡½æ•°
- **çŠ¶æ€ä¿æŒ**ï¼šåœ¨å‡½æ•°è°ƒç”¨ä¹‹é—´ä¿æŒçŠ¶æ€
- **æ¨¡å—åŒ–**ï¼šå®ç°æ¨¡å—æ¨¡å¼

---

# å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿ä¸åº”ç”¨

## å‡½æ•°å¼ç¼–ç¨‹çš„ä¼˜åŠ¿

### 1. ä»£ç ç®€æ´æ€§

å‡½æ•°å¼ç¼–ç¨‹é€šå¸¸å¯ä»¥ç”¨æ›´å°‘çš„ä»£ç è¡¨è¾¾ç›¸åŒçš„é€»è¾‘ã€‚

### 2. å¯æµ‹è¯•æ€§

çº¯å‡½æ•°æ˜“äºæµ‹è¯•ï¼Œä¸éœ€è¦è®¾ç½®å¤æ‚çš„ç¯å¢ƒã€‚

### 3. å¹¶å‘å®‰å…¨

ä¸å¯å˜æ•°æ®å’Œçº¯å‡½æ•°å¤©ç„¶çº¿ç¨‹å®‰å…¨ï¼Œé€‚åˆå¹¶å‘ç¼–ç¨‹ã€‚

### 4. å¯ç»´æŠ¤æ€§

ä»£ç æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤ï¼Œå‰¯ä½œç”¨æ›´å°‘ã€‚

### 5. å¯ç»„åˆæ€§

å°å‡½æ•°å¯ä»¥ç»„åˆæˆå¤æ‚çš„åŠŸèƒ½ã€‚

### 6. å£°æ˜å¼é£æ ¼

ä»£ç æ›´æ¥è¿‘é—®é¢˜æè¿°ï¼Œè€Œä¸æ˜¯å®ç°ç»†èŠ‚ã€‚

## é€‚ç”¨åœºæ™¯

### é€‚åˆä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„åœºæ™¯

1. **æ•°æ®å¤„ç†å’Œè½¬æ¢**
   - æ•°æ®æ¸…æ´—
   - æ•°æ®è½¬æ¢
   - æ•°æ®èšåˆ

2. **å¹¶å‘å’Œå¹¶è¡Œç¼–ç¨‹**
   - å¤šçº¿ç¨‹å¤„ç†
   - å¹¶è¡Œè®¡ç®—
   - å¼‚æ­¥ç¼–ç¨‹

3. **æ•°å­¦è®¡ç®—**
   - ç§‘å­¦è®¡ç®—
   - ç®—æ³•å®ç°
   - ç»Ÿè®¡åˆ†æ

4. **äº‹ä»¶å¤„ç†**
   - äº‹ä»¶æµå¤„ç†
   - å“åº”å¼ç¼–ç¨‹
   - å¼‚æ­¥äº‹ä»¶å¤„ç†

5. **é…ç½®å’Œç­–ç•¥**
   - ç­–ç•¥æ¨¡å¼
   - é…ç½®ç®¡ç†
   - è§„åˆ™å¼•æ“

### ä¸é€‚åˆä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹çš„åœºæ™¯

1. **æ€§èƒ½å…³é”®çš„ç³»ç»Ÿè°ƒç”¨**
2. **éœ€è¦å¤§é‡çŠ¶æ€ç®¡ç†çš„åº”ç”¨**
3. **ä¸å¤–éƒ¨ç³»ç»Ÿæ·±åº¦é›†æˆçš„åœºæ™¯**

## å‡½æ•°å¼ç¼–ç¨‹ä¸è®¾è®¡æ¨¡å¼

> [å‡½æ•°å¼ç¼–ç¨‹å®ç°è®¾è®¡æ¨¡å¼](https://klose911.github.io/html/fdp/fdp.html)

**æ ¸å¿ƒè§‚ç‚¹**ï¼š`ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼ŒGOFçš„è®¾è®¡æ¨¡å¼æ˜¯è¯­è¨€è¡¨è¾¾èƒ½åŠ›çš„ç¼ºé™·`

### ä¼ ç»Ÿè®¾è®¡æ¨¡å¼ vs å‡½æ•°å¼ç¼–ç¨‹

è®¸å¤šä¼ ç»Ÿè®¾è®¡æ¨¡å¼åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­å˜å¾—ä¸å¿…è¦ï¼š

| è®¾è®¡æ¨¡å¼ | å‡½æ•°å¼æ›¿ä»£æ–¹æ¡ˆ |
|---------|--------------|
| ç­–ç•¥æ¨¡å¼ | é«˜é˜¶å‡½æ•° |
| å‘½ä»¤æ¨¡å¼ | å‡½æ•°ä½œä¸ºå€¼ |
| æ¨¡æ¿æ–¹æ³•æ¨¡å¼ | å‡½æ•°ç»„åˆ |
| è§‚å¯Ÿè€…æ¨¡å¼ | å‡½æ•°å¼å“åº”å¼ç¼–ç¨‹ |
| è£…é¥°å™¨æ¨¡å¼ | å‡½æ•°ç»„åˆ |

> ç¤ºä¾‹ï¼šç­–ç•¥æ¨¡å¼

**ä¼ ç»Ÿé¢å‘å¯¹è±¡æ–¹å¼**ï¼š
```java
interface Strategy {
    int execute(int a, int b);
}

class AddStrategy implements Strategy {
    public int execute(int a, int b) { return a + b; }
}

class MultiplyStrategy implements Strategy {
    public int execute(int a, int b) { return a * b; }
}
```

**å‡½æ•°å¼æ–¹å¼**ï¼š
```java
BiFunction<Integer, Integer, Integer> add = (a, b) -> a + b;
BiFunction<Integer, Integer, Integer> multiply = (a, b) -> a * b;

// ç›´æ¥ä½¿ç”¨å‡½æ•°
int result1 = add.apply(5, 3);
int result2 = multiply.apply(5, 3);
```

---

# å®è·µç¤ºä¾‹

## Java ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹

### Stream API ä½¿ç”¨

```java
List<Person> people = Arrays.asList(
    new Person("Alice", 25),
    new Person("Bob", 30),
    new Person("Charlie", 35)
);

// è¿‡æ»¤å¹´é¾„å¤§äº25çš„äººï¼Œæå–å§“åï¼Œè½¬æ¢ä¸ºå¤§å†™
List<String> names = people.stream()
    .filter(p -> p.getAge() > 25)
    .map(Person::getName)
    .map(String::toUpperCase)
    .collect(Collectors.toList());
```

### Optional ä½¿ç”¨

```java
Optional<String> name = Optional.ofNullable(getName())
    .filter(n -> n.length() > 5)
    .map(String::toUpperCase);

String result = name.orElse("DEFAULT");
```

### å‡½æ•°å¼æ¥å£

```java
// è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£
@FunctionalInterface
interface TriFunction<T, U, V, R> {
    R apply(T t, U u, V v);
}

// ä½¿ç”¨
TriFunction<Integer, Integer, Integer, Integer> sum = (a, b, c) -> a + b + c;
int result = sum.apply(1, 2, 3); // 6
```

## JavaScript ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹

### æ•°ç»„æ“ä½œ

```javascript
const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

// å‡½æ•°å¼å¤„ç†
const result = numbers
    .filter(n => n % 2 === 0)    // è¿‡æ»¤å¶æ•°
    .map(n => n * n)              // å¹³æ–¹
    .reduce((sum, n) => sum + n, 0); // æ±‚å’Œ
// ç»“æœ: 220
```

### å‡½æ•°ç»„åˆ

```javascript
// å·¥å…·å‡½æ•°
const compose = (...fns) => (x) => fns.reduceRight((v, f) => f(v), x);
const pipe = (...fns) => (x) => fns.reduce((v, f) => f(v), x);

// ä½¿ç”¨
const addOne = x => x + 1;
const multiplyByTwo = x => x * 2;
const square = x => x * x;

// ç»„åˆï¼šå…ˆåŠ 1ï¼Œå†ä¹˜ä»¥2ï¼Œå†å¹³æ–¹
const composed = pipe(addOne, multiplyByTwo, square);
const result = composed(5); // ((5 + 1) * 2)^2 = 144
```

## å®é™…åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šæ•°æ®å¤„ç†ç®¡é“

```java
// å¤„ç†ç”¨æˆ·æ•°æ®ï¼šè¿‡æ»¤ã€è½¬æ¢ã€èšåˆ
List<User> users = getUsers();

Map<String, Long> result = users.stream()
    .filter(u -> u.getAge() >= 18)                    // è¿‡æ»¤æˆå¹´äºº
    .filter(u -> u.isActive())                         // è¿‡æ»¤æ´»è·ƒç”¨æˆ·
    .map(u -> u.getDepartment())                      // æå–éƒ¨é—¨
    .collect(Collectors.groupingBy(
        Function.identity(),
        Collectors.counting()                         // ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨çš„äººæ•°
    ));
```

### æ¡ˆä¾‹2ï¼šå¼‚æ­¥å¤„ç†

```java
// ä½¿ç”¨ CompletableFuture è¿›è¡Œå‡½æ•°å¼å¼‚æ­¥ç¼–ç¨‹
CompletableFuture<List<String>> future = CompletableFuture
    .supplyAsync(() -> fetchData())
    .thenApply(data -> data.stream()
        .filter(item -> item.isValid())
        .map(Item::getName)
        .collect(Collectors.toList()))
    .thenApply(names -> names.stream()
        .map(String::toUpperCase)
        .collect(Collectors.toList()));
```

### æ¡ˆä¾‹3ï¼šé…ç½®ç®¡ç†

```java
// ä½¿ç”¨å‡½æ•°å¼æ–¹å¼å¤„ç†é…ç½®
Function<String, Optional<String>> getConfig = key -> 
    Optional.ofNullable(System.getProperty(key));

Function<String, String> getConfigWithDefault(String defaultValue) {
    return key -> getConfig.apply(key).orElse(defaultValue);
}

String dbHost = getConfigWithDefault("localhost").apply("db.host");
```
