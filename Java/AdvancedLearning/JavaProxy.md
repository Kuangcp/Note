---
title: Javaä¸­çš„ä»£ç†
date: 2019-01-27 21:06:14
tags: 
categories: 
    - Java
---

ğŸ’ 

- 1. [Javaä¸­çš„ä»£ç†](#javaä¸­çš„ä»£ç†)
    - 1.1. [é™æ€ä»£ç†](#é™æ€ä»£ç†)
    - 1.2. [åŠ¨æ€ä»£ç†](#åŠ¨æ€ä»£ç†)
        - 1.2.1. [JDKåŠ¨æ€ä»£ç†](#jdkåŠ¨æ€ä»£ç†)
        - 1.2.2. [cglib](#cglib)
        - 1.2.3. [ASM](#asm)

ğŸ’  2024-11-22 11:50:47
****************************************
# Javaä¸­çš„ä»£ç†

[JavaåŠ¨æ€ä»£ç†æœºåˆ¶è¯¦è§£](http://blog.csdn.net/luanlouis/article/details/24589193) `åšå®¢å¾ˆç»†è‡´ï¼Œæ·±å…¥åŸç†`

> [å‚è€ƒ: Javaä»£ç†æ¨¡å¼æ±‡ç¼–](https://blog.csdn.net/JQ_AK47/article/details/85344634)

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå®¢æˆ·ä¸æƒ³æˆ–è€…ä¸èƒ½ç›´æ¥å¼•ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡ä¸€ä¸ªç§°ä¹‹ä¸ºâ€œä»£ç†â€çš„ç¬¬ä¸‰è€…æ¥å®ç°é—´æ¥å¼•ç”¨ã€‚ä»£ç†å¯¹è±¡å¯ä»¥åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ä»£ç†å¯¹è±¡å»æ‰å®¢æˆ·ä¸èƒ½çœ‹åˆ°çš„å†…å®¹å’ŒæœåŠ¡æˆ–è€…æ·»åŠ å®¢æˆ·éœ€è¦çš„é¢å¤–æœåŠ¡ã€‚

é€šè¿‡å¼•å…¥ä¸€ä¸ªæ–°çš„å¯¹è±¡æ¥å®ç°å¯¹çœŸå®å¯¹è±¡çš„æ“ä½œæˆ–è€…å°†æ–°çš„å¯¹è±¡ä½œä¸ºçœŸå®å¯¹è±¡çš„ä¸€ä¸ªæ›¿èº«ï¼Œè¿™ç§å®ç°æœºåˆ¶å³ä¸ºä»£ç†æ¨¡å¼ï¼Œé€šè¿‡å¼•å…¥ä»£ç†å¯¹è±¡æ¥é—´æ¥è®¿é—®ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™å°±æ˜¯ä»£ç†æ¨¡å¼çš„æ¨¡å¼åŠ¨æœºã€‚

> ä»£ç†æ¨¡å¼(Proxy Pattern) ï¼šç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ã€‚

æŒ‰ç…§ä»£ç†ç±»çš„åˆ›å»ºæ—¶æœŸï¼Œä»£ç†ç±»å¯åˆ†ä¸ºä¸¤ç§ï¼Œå³åŠ¨æ€ä»£ç†ç±»å’Œé™æ€ä»£ç†ç±». 
å°±æ˜¯æˆ‘ä»¬ç»å¸¸æåˆ°çš„é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ä¸­ä¸»è¦ç”¨åˆ°çš„ç±»ã€‚é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†çš„ä¸»è¦åŒºåˆ«å°±æ˜¯ä»£ç†ç±»åˆ›å»ºçš„æ—¶é—´ä¸åŒã€‚

é™æ€ä»£ç†é€šå¸¸åªä»£ç†ä¸€ä¸ªç±»ï¼ŒåŠ¨æ€ä»£ç†æ˜¯ä»£ç†ä¸€ä¸ªæ¥å£ä¸‹çš„å¤šä¸ªå®ç°ç±»ã€‚é™æ€ä»£ç†äº‹å…ˆçŸ¥é“è¦ä»£ç†çš„æ˜¯ä»€ä¹ˆï¼Œè€ŒåŠ¨æ€ä»£ç†ä¸çŸ¥é“è¦ä»£ç†ä»€ä¹ˆä¸œè¥¿ï¼Œåªæœ‰åœ¨è¿è¡Œæ—¶æ‰çŸ¥é“ã€‚

## é™æ€ä»£ç†
> é™æ€ä»£ç†ç±»ï¼šç”±ç¨‹åºå‘˜åˆ›å»ºæˆ–ç”±ç‰¹å®šå·¥å…·è‡ªåŠ¨ç”Ÿæˆæºä»£ç ï¼Œå†å¯¹å…¶ç¼–è¯‘ã€‚åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œä»£ç†ç±»çš„.classæ–‡ä»¶å°±å·²ç»å­˜åœ¨äº†ã€‚

```java
    //  æ¥å£ä»¥åŠå®ç°ç±» (ç›®æ ‡æ¥å£å’Œç›®æ ‡å¯¹è±¡)
    public interface HelloSerivice {
        public void say();
    }
    public class HelloSeriviceImpl implements HelloSerivice{
        @Override
        public void say() {
            System.out.println("hello world");
        }
    }
    
    // ä»£ç†ç±»(åŒæ ·å®ç°ç›®æ ‡æ¥å£), å¹¶æ‰©å±•äº†å¯¹åº”çš„æ–¹æ³•
    public class HelloSeriviceProxy implements HelloSerivice{
        private HelloSerivice target;
        public HelloSeriviceProxy(HelloSerivice target) {
            this.target = target;
        }
        @Override
        public void say() {
            System.out.println("è®°å½•æ—¥å¿—");
            target.say();
            System.out.println("å›æ”¶èµ„æº");
        }
    }

    // å•å…ƒæµ‹è¯•
    @Test
    public void testProxy(){
        //ç›®æ ‡å¯¹è±¡
        HelloSerivice target = new HelloSeriviceImpl();
        //ä»£ç†å¯¹è±¡
        HelloSeriviceProxy proxy = new HelloSeriviceProxy(target);
        proxy.say();
    }
```

è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„é™æ€çš„ä»£ç†æ¨¡å¼çš„å®ç°ã€‚ä»£ç†æ¨¡å¼ä¸­çš„æ‰€æœ‰è§’è‰²ï¼ˆä»£ç†å¯¹è±¡ã€ç›®æ ‡å¯¹è±¡ã€ç›®æ ‡å¯¹è±¡çš„æ¥å£ï¼‰ç­‰éƒ½æ˜¯åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šå¥½çš„ã€‚

- é™æ€ä»£ç†çš„ç”¨é€”
    - æ§åˆ¶çœŸå®å¯¹è±¡çš„è®¿é—®æƒé™ï¼šé€šè¿‡ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹çœŸå®å¯¹è±¡çš„ä½¿ç”¨æƒé™ã€‚
    - é¿å…åˆ›å»ºå¤§å¯¹è±¡ï¼šé€šè¿‡ä½¿ç”¨ä¸€ä¸ªä»£ç†å°å¯¹è±¡æ¥ä»£è¡¨ä¸€ä¸ªçœŸå®çš„å¤§å¯¹è±¡ï¼Œå¯ä»¥å‡å°‘ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—ï¼Œå¯¹ç³»ç»Ÿè¿›è¡Œä¼˜åŒ–å¹¶æé«˜è¿è¡Œé€Ÿåº¦ã€‚
    - å¢å¼ºçœŸå®å¯¹è±¡çš„åŠŸèƒ½ï¼šé€šè¿‡ä»£ç†å¯ä»¥åœ¨è°ƒç”¨çœŸå®å¯¹è±¡çš„æ–¹æ³•çš„å‰åå¢åŠ é¢å¤–åŠŸèƒ½ã€‚

************************

## åŠ¨æ€ä»£ç†
> åŠ¨æ€ä»£ç†ç±»ï¼šåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œè¿ç”¨åå°„æœºåˆ¶åŠ¨æ€åˆ›å»ºè€Œæˆã€‚åŠ¨æ€ä»£ç†ä¸­çš„ä»£ç†ç±»å¹¶ä¸è¦æ±‚åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šï¼Œè€Œæ˜¯å¯ä»¥åœ¨è¿è¡ŒæœŸåŠ¨æ€ç”Ÿæˆï¼Œä»è€Œå®ç°å¯¹ç›®æ ‡å¯¹è±¡çš„ä»£ç†åŠŸèƒ½ã€‚

> [å‚è€ƒ: JavaåŠ¨æ€ä»£ç†æœºåˆ¶è¯¦è§£ï¼ˆJDK å’ŒCGLIBï¼ŒJavassistï¼ŒASMï¼‰](https://blog.csdn.net/luanlouis/article/details/24589193)

é™æ€ä»£ç†çš„ç¼ºç‚¹æ˜¯æƒ³ç”¨è¿™æ ·çš„ä»£ç†å°±å¿…é¡»è¦æ‰‹åŠ¨ç¡¬ç¼–ç å®ç°, æ¯”è¾ƒç¹ç, å°¤å…¶æ˜¯æ¥å£ä¸­çš„æ–¹æ³•å¾ˆå¤šçš„æ—¶å€™, åŠ¨æ€ä»£ç†å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜  
åœ¨æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„æ¡†æ¶ä¸­ï¼Œåƒservletçš„filterã€åŒ…æ‹¬springæä¾›çš„aopä»¥åŠstruts2çš„æ‹¦æˆªå™¨, mybatisåˆ†é¡µæ’ä»¶ï¼Œä»¥åŠæ—¥å¿—æ‹¦æˆªã€äº‹åŠ¡æ‹¦æˆªã€æƒé™æ‹¦æˆªè¿™äº›å‡ ä¹å…¨éƒ¨æœ‰åŠ¨æ€ä»£ç†çš„èº«å½±ã€‚

- å¾€å¾€å®ç°åŠ¨æ€ä»£ç†æœ‰ä¸¤ç§æ–¹å¼:
    - JDKåŠ¨æ€ä»£ç†: `java.lang.reflect` åŒ…ä¸­çš„`Proxy`ç±»å’Œ`InvocationHandler`æ¥å£æä¾›äº†ç”ŸæˆåŠ¨æ€ä»£ç†ç±»çš„èƒ½åŠ›ã€‚
    - Cglib: æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹ä»£ç ç”Ÿæˆç±»åº“ï¼Œè¿è¡Œæ—¶åœ¨å†…å­˜ä¸­åŠ¨æ€ç”Ÿæˆä¸€ä¸ªå­ç±»å¯¹è±¡ä»è€Œå®ç°å¯¹ç›®æ ‡å¯¹è±¡åŠŸèƒ½çš„æ‰©å±•ã€‚

### JDKåŠ¨æ€ä»£ç†
> [Oracle api](https://docs.oracle.com/javase/8/docs/api/) 

jdkåŠ¨æ€ä»£ç†æ˜¯ç”±javaå†…éƒ¨çš„åå°„æœºåˆ¶æ¥å®ç°çš„
JDKåŠ¨æ€ä»£ç†æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œå°±æ˜¯ä½¿ç”¨åŠ¨æ€ä»£ç†çš„å¯¹è±¡å¿…é¡»å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£ã€‚å› ä¸ºJDKåŠ¨æ€ä»£ç†åªèƒ½å¯¹æ¥å£äº§ç”Ÿä»£ç†ï¼Œä¸èƒ½å¯¹ç±»äº§ç”Ÿä»£ç†

### cglib
> `It is used by AOP, testing, data access frameworks to generate dynamic proxy objects and intercept field access.`

[Cglib (Byte Code Generation Library)](https://github.com/cglib/cglib) 

Cglibæ˜¯é’ˆå¯¹ç±»æ¥å®ç°ä»£ç†çš„(æ‰€ä»¥æ— éœ€å£°æ˜æ¥å£)ï¼Œä»–çš„åŸç†æ˜¯å¯¹ä»£ç†çš„ç›®æ ‡ç±»ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œå¹¶è¦†ç›–å…¶ä¸­æ–¹æ³•å®ç°å¢å¼ºï¼Œå› ä¸ºåº•å±‚æ˜¯åŸºäºåˆ›å»ºè¢«ä»£ç†ç±»çš„ä¸€ä¸ªå­ç±»ï¼Œæ‰€ä»¥å®ƒé¿å…äº†JDKåŠ¨æ€ä»£ç†ç±»çš„ç¼ºé™·.  
CglibåŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå°è€Œå¿«çš„å­—èŠ‚ç å¤„ç†æ¡†æ¶ASMï¼Œæ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»ã€‚ä¸é¼“åŠ±ç›´æ¥ä½¿ç”¨ASMï¼Œå› ä¸ºå®ƒéœ€è¦ä½ å¯¹JVMå†…éƒ¨ç»“æ„åŒ…æ‹¬classæ–‡ä»¶çš„æ ¼å¼å’ŒæŒ‡ä»¤é›†éƒ½å¾ˆç†Ÿæ‚‰ã€‚

è¿™å°±ä¸å¾—ä¸è¯´åˆ°CgLibçš„ç‰¹ç‚¹ï¼šåˆ›å»ºé€Ÿåº¦æ…¢ä½†æ‰§è¡Œé€Ÿåº¦å¿«ï¼Œè€ŒJDKçš„åŠ¨æ€ä»£ç†ä¸å…¶åˆšå¥½ç›¸åï¼šåˆ›å»ºé€Ÿåº¦å¿«ä½†æ‰§è¡Œé€Ÿåº¦æ…¢ã€‚
å¦‚æœåœ¨ç¨‹åºè¿è¡Œæ—¶ä¸æ–­åœ°ä½¿ç”¨CgLibå»åˆ›å»ºä»£ç†çš„è¯ï¼Œç³»ç»Ÿè¿è¡Œçš„æ€§èƒ½ä¼šå¤§æ‰“æŠ˜æ‰£ï¼Œæ‰€ä»¥å»ºè®®ä¸€èˆ¬åœ¨ç³»ç»Ÿåˆå§‹åŒ–æ—¶é‡‡ç”¨CgLibæ¥åˆ›å»ºä»£ç†ï¼Œå¹¶æ”¾å…¥Springçš„ApplicationContextä¸­ã€‚

### ASM
> [Official site](https://asm.ow2.io/) | [Github](https://github.com/llbit/ow2-asm)

> [ä½¿ç”¨ ASM å®ç° Java è¯­è¨€çš„â€œå¤šé‡ç»§æ‰¿â€](https://www.ibm.com/developerworks/cn/java/j-lo-asm/)
