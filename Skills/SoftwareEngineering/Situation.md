---
title: 场景&方案
date: 2023-09-22 16:56:45
tags: 
categories: 
---

**目录 start**

1. [方向需求](#方向需求)
    1. [系统重构](#系统重构)
1. [业务需求](#业务需求)
    1. [千万级数据导入](#千万级数据导入)
    1. [千万级数据导出](#千万级数据导出)

**目录 end**|_2023-09-22 16:56_|
****************************************
# 方向需求
## 系统重构
> [知乎社区核心业务 Golang 化实践](https://zhuanlan.zhihu.com/p/48039838)`Python所开发的模块使用Go重写`

场景:

思考点:

************************

# 业务需求
## 千万级数据导入
场景: 将数据库外的千万或亿级Excel CSV txt等文件导入到数据库

思考点:
1. 导入时 用户并发,数据库资源控制
    - 操作的频率, 导入的效率
1. 应用层资源优化,JVM内存 CPU占用
    - 需要按实际导入端,考虑是经过JVM应用层处理,还是直接利用数据库的附属工具或机制
1. 落库的类型和特点: NoSQL 或 关系型数据库
    - 

方案:

> NoSQL

> 关系型数据库
1. MySQL
    - 
1. Clickhouse 
    - 
1. GreenPlum 
    - copy 方式, 不经过应用端去做 数据解析和写入

## 千万级数据导出
场景: 数据库内大表输出为 csv,Excel  

思考点: 
- 导出时 用户并发及数据库资源控制
    - 如何在应用层接入端去感知数据库的资源状态, 协同控制并发频率 (比如: 应用层接受到请求,参考数据库资源状态设置并发数和导出数据量的约束, 而不是设置抽象的限流策略)
- 字段多且大存储高
    - 如何平衡数据导出效率 和 应用JVM投入资源
- 使用独占长连接完整SQL查询数据库 和 共享连接查询分批SQL 的取舍 `简单理解为分页和不分页`
    - 独占连接: 完整SQL查询然后不关闭连接使用游标分批去数据库fetch数据, 最后汇总
    - 共享连接: SQL层加分页或者条件范围 查询小批结果集, 最后汇总

方案:
- 

